
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Menú Digital</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f9f9f9;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
        }

        .menu-container, .tabs {
            width: 80%;
            max-width: 1200px;
            margin: 20px;
        }

        .tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
        }

        .tab {
            padding: 10px 20px;
            cursor: pointer;
            background-color: #fff;
            border: 1px solid #ccc;
            border-radius: 5px;
            margin: 0 5px;
            transition: background-color 0.2s;
        }

        .tab:hover, .tab.active {
            background-color: #007bff;
            color: #fff;
        }

        .menu {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            padding: 20px;
        }

        .menu-item {
            border: 1px solid #ccc;
            border-radius: 10px;
            padding: 10px;
            margin: 10px;
            width: 200px;
            text-align: center;
            background-color: #fff;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .menu-item:hover {
            transform: scale(1.05);
        }

        .cart {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            padding: 20px;
            width: 300px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .cart-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid #ccc;
        }

        .cart-item h3, .cart-item p {
            margin: 0;
        }

        .cart-item button {
            padding: 5px 10px;
            background-color: #dc3545;
            color: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .cart-item button:hover {
            background-color: #c82333;
        }

        .cart-total {
            text-align: right;
            font-size: 1.2em;
            margin-top: 20px;
        }

        #order-btn, #share-btn {
            margin-top: 20px;
            padding: 10px 20px;
            background-color: #007bff;
            color: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        #order-btn:hover, #share-btn:hover {
            background-color: #0069d9;
        }

        #share-btn {
            margin-left: 10px;
        }
    </style>
</head>
<body>
    <div class="tabs">
        <!-- Las pestañas de categorías se insertarán aquí dinámicamente -->
    </div>
    <div class="menu-container">
        <div class="menu" id="menu">
            <h2>Menú</h2>
            <!-- Los items del menú se insertarán aquí dinámicamente -->
        </div>
    </div>
    <div class="cart" id="cart">
        <h2>Carrito</h2>
        <!-- Los items del carrito se insertarán aquí dinámicamente -->
        <div class="cart-total" id="cart-total">Subtotal: $0.00</div>
        <button id="order-btn">Hacer Pedido</button>
        <button id="share-btn">Compartir Lista</button>
    </div>

    <script>
        const SHEET_ID = 'TU_GOOGLE_SHEET_ID';
        const API_KEY = 'TU_API_KEY';
        const SHEET_NAME = 'Hoja1';

        const menuContainer = document.getElementById('menu');
        const cartContainer = document.getElementById('cart');
        const cartTotal = document.getElementById('cart-total');
        const tabsContainer = document.querySelector('.tabs');
        let cart = [];
        let products = [];
        let categories = new Set();

        fetch(`https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${SHEET_NAME}?key=${API_KEY}`)
            .then(response => response.json())
            .then(data => {
                const rows = data.values;
                rows.forEach(row => {
                    const [name, price, category] = row;
                    products.push({ name, price, category });
                    categories.add(category);
                });
                renderTabs();
                renderMenu('Todas');
            })
            .catch(error => console.error('Error fetching data from Google Sheets:', error));

        function renderTabs() {
            tabsContainer.innerHTML = '';
            const allTab = document.createElement('div');
            allTab.classList.add('tab', 'active');
            allTab.innerText = 'Todas';
            allTab.addEventListener('click', () => renderMenu('Todas'));
            tabsContainer.appendChild(allTab);

            categories.forEach(category => {
                const tab = document.createElement('div');
                tab.classList.add('tab');
                tab.innerText = category;
                tab.addEventListener('click', () => renderMenu(category));
                tabsContainer.appendChild(tab);
            });
        }

        function renderMenu(category) {
            menuContainer.innerHTML = '<h2>Menú</h2>';
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelector(`.tab:contains(${category})`).classList.add('active');
            products.filter(product => category === 'Todas' || product.category === category).forEach(product => {
                const menuItem = document.createElement('div');
                menuItem.classList.add('menu-item');
                menuItem.innerHTML = `
                    <div>
                        <h3>${product.name}</h3>
                        <p>$${product.price}</p>
                    </div>
                    <button onclick="addToCart('${product.name}', ${product.price})">Agregar</button>
                `;
                menuContainer.appendChild(menuItem);
            });
        }

        function addToCart(name, price) {
            const cartItem = cart.find(item => item.name === name);
            if (cartItem) {
                cartItem.quantity += 1;
            } else {
                cart.push({ name, price, quantity: 1 });
            }
            renderCart();
        }

        function removeFromCart(name) {
            const cartItemIndex = cart.findIndex(item => item.name === name);
            if (cartItemIndex > -1) {
                cart[cartItemIndex].quantity -= 1;
                if (cart[cartItemIndex].quantity === 0) {
                    cart.splice(cartItemIndex, 1);
                }
            }
            renderCart();
        }

        function renderCart() {
            const cartItemsContainer = cartContainer.querySelector('.cart-items');
            if (cartItemsContainer) {
                cartItemsContainer.remove();
            }
            const newCartItemsContainer = document.createElement('div');
            newCartItemsContainer.classList.add('cart-items');
            let subtotal = 0;
            cart.forEach(item => {
                subtotal += item.price * item.quantity;
                const cartItem = document.createElement('div');
                cartItem.classList.add('cart-item');
                cartItem.innerHTML = `
                    <div>
                        <h3>${item.name}</h3>
                        <p>$${item.price} x ${item.quantity}</p>
                    </div>
                    <button onclick="removeFromCart('${item.name}')">Eliminar</button>
                `;
                newCartItemsContainer.appendChild(cartItem);
            });
            cartContainer.insertBefore(newCartItemsContainer, cartTotal);
            cartTotal.textContent = `Subtotal: $${subtotal.toFixed(2)}`;
        }

        document.getElementById('order-btn').addEventListener('click', () => {
            if (cart.length === 0) {
                alert('Por favor, agrega al menos un elemento al carrito.');
                return;
            }

            let orderText = 'Hola, quisiera ordenar:\n';
            cart.forEach(item => {
                orderText += `${item.name} x ${item.quantity} = $${(item.price * item.quantity).toFixed(2)}\n`;
            });
            orderText += `\nSubtotal: $${cart.reduce((sum, item) => sum + item.price * item.quantity, 0).toFixed(2)}`;

            const whatsappNumber = '1234567890';  // Cambia esto por el número de WhatsApp del restaurante
            const whatsappUrl = `https://wa.me/${whatsappNumber}?text=${encodeURIComponent(orderText)}`;
            window.open(whatsappUrl, '_blank');
        });

        document.getElementById('share-btn').addEventListener('click', () => {
            if (cart.length === 0) {
                alert('Por favor, agrega al menos un elemento al carrito.');
                return;
            }

            let shareText = 'Mira mi lista de productos:\n';
            cart.forEach(item => {
                shareText += `${item.name} x ${item.quantity} = $${(item.price * item.quantity).toFixed(2)}\n`;
            });
            shareText += `\nSubtotal: $${cart.reduce((sum, item) => sum + item.price * item.quantity, 0).toFixed(2)}`;

            const shareUrl = `https://wa.me/?text=${encodeURIComponent(shareText)}`;
            window.open(shareUrl, '_blank');
        });
    </script>
</body>
</html>
